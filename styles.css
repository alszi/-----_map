/* ========== 모바일 우선 색상 토큰 (시안 톤 매칭) ========== */
:root{
  /* 배경/텍스트 */
  --bg:        #f5f6f9;
  --ink:       #111314;
  --muted:     #6b7380;

  /* 카드/구분선 */
  --card:      #ffffff;
  --divider:   #d9d9d9;

  /* 지도 톤 */
  --pitch:     #ccd8b8; /* 잔디 */
  --skybar:    #d2d9e4; /* 상단/하단 파스텔 바 */

  /* 칩 색상 */
  --chip-sci-bg:   #d7e6ff; --chip-sci-fg:#1b3a7a;
  --chip-ai-bg:    #e9ddff; --chip-ai-fg:#4f3390;
  --chip-math-bg:  #fbf2b9; --chip-math-fg:#6a5600;
  --chip-guitar-bg:#f3f4f7; --chip-guitar-fg:#374151; /* ✅ 기타 */

  --chip-outline-fg:#374151; --chip-outline-bd:#d5dae5;

  /* 기본 배지 & 컨트롤/하이라이트 */
  --badge:     #f2eecd;
  --ctrl-bg:   rgba(255,255,255,.92);
  --ctrl-bd:   #cfd5e2;
  --hi:        #ffd166;
}

/* ========== 기본 + 전체 스크롤 비활성화 ========== */
*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0;
  background: var(--bg);
  color: var(--ink);
  font-family: "Noto Sans KR", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  overflow: hidden; /* ✅ 전체 스크롤 막기 */
}

/* ========== 상단 히어로 (시안 큰 흰 카드) ========== */
.hero{
  position: sticky; top:0; z-index: 5;
  padding: 18px 20px 10px;
  background: linear-gradient(var(--bg) 0 60%, #d7dde7 100%);
}
.hero h1{
  margin:0;
  background: var(--card);
  border-radius: 22px;
  padding: 28px 20px;
  font-size: 22px; font-weight: 700;
  box-shadow: 0 4px 16px rgba(0,0,0,.06);
}

/* ========== 지도 ========== */
.map-section{
  position: relative;
  margin: 0 16px;
  border-radius: 14px;
  overflow: hidden;
  min-height: 280px;
  background:
    linear-gradient(var(--skybar), var(--skybar)) top/100% 56px no-repeat,
    linear-gradient(var(--skybar), var(--skybar)) bottom/100% 56px no-repeat,
    var(--pitch);
  box-shadow: inset 0 0 0 6px rgba(255,255,255,.35);
}
.map-object{ width:100%; height:360px; display:block; }

/* 지도 컨트롤 */
.map-toolbar{
  position: absolute; right: 10px; top: 10px; z-index: 2;
  display: flex; flex-direction: column; gap: 8px;
}
.map-toolbar button{
  background: var(--ctrl-bg);
  border: 1px solid var(--ctrl-bd);
  border-radius: 10px;
  padding: 6px 8px;
  font-size: 16px;
}

/* ========== 하단 패널(칩 + 리스트) : 고정 + 확장 시 전체 덮기 ========== */
.panel{
  position: fixed; left: 0; right: 0; bottom: 0;
  height: 45%;               /* 기본: 화면 하단 45% */
  background: var(--card);
  border-radius: 24px 24px 0 0;
  box-shadow: 0 -10px 30px rgba(0,0,0,.06);
  display: flex; flex-direction: column;
  transition: height .28s ease, border-radius .28s ease;
  z-index: 10;
}
.panel.expanded{
  height: 100%;             /* ✅ 전체 덮기 */
  border-radius: 0;
  z-index: 20;
}

/* 패널 토글: 기본 ▲ 모양 (위 방향) + 확장 시 ▼ */
.panel-toggle{
  position: absolute; left: 50%; transform: translate(-50%,-50%);
  top: 0;
  background: var(--card);
  border: 1px solid var(--divider);
  width: 52px; height: 36px; border-radius: 12px;
  display: grid; place-items:center;
}
.panel-toggle .chevron{
  width: 14px; height: 14px;
  border-right: 2px solid var(--ink);
  border-bottom: 2px solid var(--ink);
  transform: rotate(-135deg); /* 위쪽 화살표 */
  transition: transform .28s ease;
}
.panel.expanded .panel-toggle .chevron{
  transform: rotate(45deg); /* 아래쪽 화살표 */
}

/* 칩 영역 */
.chips{
  display:flex; flex-wrap:wrap; gap:10px;
  padding: 56px 16px 8px; /* 상단 토글 버튼 공간 확보 */
}

/* 칩 기본 + 눌림 가시성 강화 */
.chip{
  position: relative;
  border: none; border-radius: 24px; padding: 10px 14px;
  font-weight: 700; font-size: 14px;
  transition: transform .12s ease, box-shadow .12s ease, outline-color .12s ease, background-color .12s ease;
}
.chip:not(.is-active){ opacity: .85; }
.chip.is-active{
  outline: 2px solid currentColor;
  outline-offset: 0;
  box-shadow:
    inset 0 0 0 2px rgba(0,0,0,.08),
    0 2px 0 rgba(0,0,0,.06);
  transform: translateY(-1px);
}
.chip.is-active::after{
  content: "✓";
  position: absolute;
  top: -6px; right: -6px;
  width: 18px; height: 18px; border-radius: 50%;
  display: grid; place-items: center;
  font-size: 12px; font-weight: 800;
  color: #fff;
  background: currentColor;
  box-shadow: 0 2px 6px rgba(0,0,0,.18);
}
.chip:focus-visible{
  outline: 3px solid #1a66ff;
  outline-offset: 2px;
}
#chipAll{
  background: transparent; color: var(--chip-outline-fg);
  border:1px solid var(--chip-outline-bd);
}
#chipAll.is-active::after{ content: none; }

/* 칩별 색 */
.chip[data-tag="sci"]   { background: var(--chip-sci-bg);   color: var(--chip-sci-fg); }
.chip[data-tag="ai"]    { background: var(--chip-ai-bg);    color: var(--chip-ai-fg); }
.chip[data-tag="math"]  { background: var(--chip-math-bg);  color: var(--chip-math-fg); }
.chip[data-tag="guitar"]{ background: var(--chip-guitar-bg);color: var(--chip-guitar-fg); }

/* 리스트: 패널 내부에서만 스크롤 */
.list{
  padding: 8px 16px 12px;
  overflow-y: auto;     /* ✅ 내부만 스크롤 */
  -webkit-overflow-scrolling: touch;
  flex: 1 1 auto;       /* 칩 아래 남은 공간 채움 */
}
.item{
  display:grid;
  grid-template-columns: 44px 72px 1fr 14px;
  align-items:center; gap: 12px;
  padding: 14px 0;
  border-bottom: 1px solid var(--divider);
}
.item:last-child{ border-bottom:none; }

/* 번호 배지 — 태그별로 칩 색상과 일치 */
.badge{
  width: 36px; height: 36px; border-radius: 50%;
  display:grid; place-items:center;
  font-weight: 800;
  background: var(--badge);
}
.badge[data-tag="sci"]    { background: var(--chip-sci-bg);    color: var(--chip-sci-fg); }
.badge[data-tag="ai"]     { background: var(--chip-ai-bg);     color: var(--chip-ai-fg); }
.badge[data-tag="math"]   { background: var(--chip-math-bg);   color: var(--chip-math-fg); }
.badge[data-tag="guitar"] { background: var(--chip-guitar-bg); color: var(--chip-guitar-fg); }

/* 썸네일(회색 박스) */
.thumb{
  width: 72px; height: 72px; border-radius: 12px;
  background: #e7e8ed; display:grid; place-items:center;
  color:#8b92a3; font-size: 12px; font-weight:600;
}

/* 텍스트 */
.info{ min-width:0; }
.title{ margin:0 0 6px; font-size: 18px; font-weight: 800; }
.desc{ margin:0; color: var(--muted); font-size: 14px; }

/* 우측 작은 점 버튼 */
.view-btn{
  background: transparent; border: none; color: #9aa2b4;
  font-size: 18px; transform: translateY(-8px);
}

/* ========== SVG 하이라이트 ========== */
.svg-highlight{
  filter: drop-shadow(0 0 6px rgba(255,209,102,.95));
  stroke: var(--hi) !important;
  stroke-width: 3 !important;
  animation: blink .9s ease-in-out 0s 2;
}
@keyframes blink{ 50%{ opacity: .35 } }

/* ========== 반응형 스케일업 (모바일 우선) ========== */
@media (min-width: 480px){
  .hero h1{ padding: 32px 22px; font-size: 24px; }
  .map-object{ height: 400px; }
  .item{ grid-template-columns: 48px 84px 1fr 16px; gap: 14px; }
  .badge{ width: 40px; height: 40px; }
  .thumb{ width: 84px; height: 84px; }
  .title{ font-size: 19px; }
}
@media (min-width: 768px){
  body{ max-width: 720px; margin: 0 auto; }
  .hero{ padding: 24px 0 12px; }
  .map-section{ margin: 0 0 8px; border-radius: 16px; }
  .panel{ border-radius: 20px 20px 0 0; }
  .map-object{ height: 480px; }
  .chips{ padding: 60px 20px 12px; gap: 12px; }
  .list{ padding: 10px 20px 14px; }
}
